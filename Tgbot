import logging
from telegram import Update, ReplyKeyboardMarkup, InlineKeyboardMarkup, InlineKeyboardButton
from telegram.ext import (
    Application,
    CommandHandler,
    MessageHandler,
    CallbackQueryHandler,
    filters,
    ContextTypes
)

logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s', 
    level=logging.INFO
)
logger = logging.getLogger(__name__)  

TOKEN = ''

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    keyboard = [
        ["üéì –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏", "üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ"],
        ["üè¢ –ö–æ–Ω—Ç–∞–∫—Ç—ã"],
        ["üìû –°–≤—è–∑—å —Å –ø—Ä–∏–µ–º–Ω–æ–π –∫–æ–º–∏—Å—Å–∏–µ–π", "üìã –ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–µ–º–∞"]
    ]
    
    reply_markup = ReplyKeyboardMarkup(keyboard, resize_keyboard=True, one_time_keyboard=False)
    
    await update.message.reply_text(
        "üè´ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç —Ç–µ—Ö–Ω–∏–∫—É–º–∞!\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –≤–∞—Å —Ä–∞–∑–¥–µ–ª:",
        reply_markup=reply_markup
    )

async def handle_buttons(update: Update, context: ContextTypes.DEFAULT_TYPE):
    text = update.message.text
    
    if text == "üéì –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏":
        # –ò–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        keyboard = [
            [InlineKeyboardButton("üíª IT-–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è", callback_data="spec_it")],
            [InlineKeyboardButton("üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏", callback_data="spec_tech")],
            [InlineKeyboardButton("üìä –≠–∫–æ–Ω–æ–º–∏–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ", callback_data="spec_economy")],
            [InlineKeyboardButton("üë®‚Äçüè≠ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ", callback_data="spec_prof")]
        ]
        reply_markup = InlineKeyboardMarkup(keyboard)
        await update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏:", reply_markup=reply_markup)
    
    elif text == "üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ":
        keyboard = [
            [InlineKeyboardButton("üóìÔ∏è –ì—Ä–∞—Ñ–∏–∫ —É—á–µ–±–Ω–æ–≥–æ –≥–æ–¥–∞", callback_data="schedule_year")],
            [InlineKeyboardButton("üìù –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —ç–∫–∑–∞–º–µ–Ω–æ–≤", callback_data="schedule_exams")]
        ]
        reply_markup = InlineKeyboardMarkup(keyboard)
        await update.message.reply_text("–ö–∞–∫–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?", reply_markup=reply_markup)
    
    elif text == "üè¢ –ö–æ–Ω—Ç–∞–∫—Ç—ã":
        contact_info = """
üìû *–ö–æ–Ω—Ç–∞–∫—Ç—ã —Ç–µ—Ö–Ω–∏–∫—É–º–∞:*
        
*–ê–¥—Ä–µ—Å:* –≥. –ò–∂–µ–≤—Å–∫, —É–ª. –ú–æ–ª–æ–¥–µ–∂–Ω–∞—è 109
*–¢–µ–ª–µ—Ñ–æ–Ω:* +7 (3412) 37-02-88
*Email:* ikoopteh@mail.ru
*–°–∞–π—Ç:* https://koopteh.ru/

‚è∞ *–ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã:*
–ü–Ω-–ü—Ç: 8:30 - 18:00
–°–±: 8:00 - 15:00
–í—Å: –≤—ã—Ö–æ–¥–Ω–æ–π
        """
        await update.message.reply_text(contact_info, parse_mode='Markdown')
    
    elif text == "üìû –°–≤—è–∑—å —Å –ø—Ä–∏–µ–º–Ω–æ–π –∫–æ–º–∏—Å—Å–∏–µ–π":
        keyboard = [[InlineKeyboardButton("–ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø—Ä–∏–µ–º–Ω—É—é –∫–æ–º–∏—Å—Å–∏—é", url="https://koopteh.ru/abiturientu")]]
        reply_markup = InlineKeyboardMarkup(keyboard)
        await update.message.reply_text(
            "üìû *–ü—Ä–∏–µ–º–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è:*\n"
            "*–¢–µ–ª–µ—Ñ–æ–Ω:* (3412)370288\n"
            "*Email:* natalyvlad2013@yandex.ru\n"
            "*–ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã:* –ü–Ω-–ü—Ç 9:00-17:00",
            reply_markup=reply_markup,
            parse_mode='Markdown'
        )
    
    elif text == "üìã –ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–µ–º–∞":
        rules_text = """
üìã *–ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–µ–º–∞ 2024/2025 —É—á–µ–±–Ω—ã–π –≥–æ–¥*

*–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:*
1. –ü–∞—Å–ø–æ—Ä—Ç (–∫–æ–ø–∏—è)
2. –ê—Ç—Ç–µ—Å—Ç–∞—Ç (–æ—Ä–∏–≥–∏–Ω–∞–ª + –∫–æ–ø–∏—è)
3. 4 —Ñ–æ—Ç–æ 3√ó4
4. –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞ 086/—É
5. –°–ù–ò–õ–° (–∫–æ–ø–∏—è)

*–°—Ä–æ–∫–∏ –ø—Ä–∏–µ–º–∞:*
‚Ä¢ –ù–∞ –±–∞–∑–µ 9 –∫–ª–∞—Å—Å–æ–≤: 20 –∏—é–Ω—è - 15 –∞–≤–≥—É—Å—Ç–∞
‚Ä¢ –ù–∞ –±–∞–∑–µ 11 –∫–ª–∞—Å—Å–æ–≤: 20 –∏—é–Ω—è - 10 –∞–≤–≥—É—Å—Ç–∞
        """
        await update.message.reply_text(rules_text, parse_mode='Markdown')
    
    else:
        await update.message.reply_text(
            "–Ø –Ω–µ –ø–æ–Ω–∏–º–∞—é —ç—Ç—É –∫–æ–º–∞–Ω–¥—É. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é.",
            reply_markup=ReplyKeyboardMarkup(
                [
                    ["üéì –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏", "üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ"],
                    ["üè¢ –ö–æ–Ω—Ç–∞–∫—Ç—ã"],
                    ["üìû –°–≤—è–∑—å —Å –ø—Ä–∏–µ–º–Ω–æ–π –∫–æ–º–∏—Å—Å–∏–µ–π", "üìã –ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–µ–º–∞"]
],
                resize_keyboard=True
            )
        )

async def handle_inline_buttons(update: Update, context: ContextTypes.DEFAULT_TYPE):
    query = update.callback_query
    await query.answer()
    
    if query.data == "spec_it":
        response = """
üíª *IT-–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è:*

1. *09.02.07* - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ
   ‚Ä¢ –ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è: –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –≤–µ–± –∏ –º—É–ª—å—Ç–∏–º–µ–¥–∏–π–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
   ‚Ä¢ –°—Ä–æ–∫: 3 –≥–æ–¥–∞ 10 –º–µ—Å—è—Ü–µ–≤
   
        """
    elif query.data == "spec_economy":
        response = """
üìä *–≠–∫–æ–Ω–æ–º–∏–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:*

1. *38.02.01* - –≠–∫–æ–Ω–æ–º–∏–∫–∞ –∏ –±—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π —É—á–µ—Ç
   ‚Ä¢ –ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è: –ë—É—Ö–≥–∞–ª—Ç–µ—Ä
   ‚Ä¢ –°—Ä–æ–∫: 2 –≥–æ–¥–∞ 10 –º–µ—Å—è—Ü–µ–≤
   
2. *38.02.04* - –ö–æ–º–º–µ—Ä—Ü–∏—è
   ‚Ä¢ –ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è: –ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º
   ‚Ä¢ –°—Ä–æ–∫: 2 –≥–æ–¥–∞ 10 –º–µ—Å—è—Ü–µ–≤
        """
    
    elif query.data == "schedule_year":
        response = """
üóìÔ∏è *–ì—Ä–∞—Ñ–∏–∫ —É—á–µ–±–Ω–æ–≥–æ –≥–æ–¥–∞ 2024/2025:*

‚Ä¢ *1 —Å–µ–Ω—Ç—è–±—Ä—è* - –ù–∞—á–∞–ª–æ —É—á–µ–±–Ω–æ–≥–æ –≥–æ–¥–∞
‚Ä¢ *30 –æ–∫—Ç—è–±—Ä—è - 6 –Ω–æ—è–±—Ä—è* - –û—Å–µ–Ω–Ω–∏–µ –∫–∞–Ω–∏–∫—É–ª—ã
‚Ä¢ *28 –¥–µ–∫–∞–±—Ä—è - 12 —è–Ω–≤–∞—Ä—è* - –ó–∏–º–Ω–∏–µ –∫–∞–Ω–∏–∫—É–ª—ã
‚Ä¢ *24 –º–∞—Ä—Ç–∞ - 31 –º–∞—Ä—Ç–∞* - –í–µ—Å–µ–Ω–Ω–∏–µ –∫–∞–Ω–∏–∫—É–ª—ã
‚Ä¢ *31 –º–∞—è* - –û–∫–æ–Ω—á–∞–Ω–∏–µ —É—á–µ–±–Ω–æ–≥–æ –≥–æ–¥–∞
        """
    
    elif query.data == "schedule_exams":
        response = """
üìù *–°–µ—Å—Å–∏—è –ª–µ—Ç–Ω—è—è 2025:*

‚Ä¢ *26 –º–∞—è - 7 –∏—é–Ω—è* - –≠–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–µ—Å—Å–∏—è
‚Ä¢ *9 –∏—é–Ω—è - 21 –∏—é–Ω—è* - –ü–µ—Ä–µ—Å–¥–∞—á–∏
‚Ä¢ *23 –∏—é–Ω—è* - –í—ã–¥–∞—á–∞ –¥–∏–ø–ª–æ–º–æ–≤ –≤—ã–ø—É—Å–∫–Ω–∏–∫–∞–º
        """
    
    else:
        response = "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞"
    
    await query.edit_message_text(response, parse_mode='Markdown')

def main():
    application = Application.builder().token(TOKEN).build()
    
    application.add_handler(CommandHandler("start", start))
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_buttons))
    application.add_handler(CallbackQueryHandler(handle_inline_buttons))
    
    logger.info("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω...")
    application.run_polling()

if __name__ == '__main__':  
    main()
